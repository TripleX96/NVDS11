<!-- Live Chat Widget Styles -->
<style>
  :root {
    --lc-primary: #2563eb;
    --lc-header-bg: #111827;
    --lc-body-bg: #ffffff;
    --lc-surface: #f9fafb;
    --lc-muted: #e5e7eb;
    --lc-text: #111827;
    --lc-shadow: 0 8px 28px rgba(0,0,0,0.18), 0 2px 8px rgba(0,0,0,0.12);
    --lc-radius: 8px;
    --lc-gap: 8px;
    --lc-transition: 180ms cubic-bezier(.2,.7,.2,1);
  }
  .lc-toggle {
    position: fixed;
    right: calc(16px + env(safe-area-inset-right));
    bottom: calc(16px + env(safe-area-inset-bottom));
    z-index: 9999;
    width: 56px;
    height: 56px;
    border-radius: 9999px;
    border: none;
    background: var(--lc-primary);
    color: #fff;
    display: grid;
    place-items: center;
    font: 600 14px/1 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    box-shadow: var(--lc-shadow);
    cursor: pointer;
    transition: transform var(--lc-transition), box-shadow var(--lc-transition), background var(--lc-transition);
  }
  .lc-toggle:hover { transform: translateY(-1px); }
  .lc-toggle:active { transform: translateY(0); }
  .lc-toggle:focus-visible { outline: 3px solid #93c5fd; outline-offset: 2px; }
  .lc-panel {
    position: fixed;
    right: calc(16px + env(safe-area-inset-right));
    bottom: calc(84px + env(safe-area-inset-bottom));
    z-index: 9999;
    width: 360px;
    max-width: calc(100vw - 24px);
    background: var(--lc-body-bg);
    border-radius: var(--lc-radius);
    box-shadow: var(--lc-shadow);
    overflow: hidden;
    opacity: 0;
    transform: translateY(8px) scale(.98);
    visibility: hidden;
    pointer-events: none;
    transition: opacity var(--lc-transition), transform var(--lc-transition), visibility 0s linear var(--lc-transition);
  }
  .lc-panel.is-open { opacity: 1; transform: translateY(0) scale(1); visibility: visible; pointer-events: auto; transition: opacity var(--lc-transition), transform var(--lc-transition), visibility 0s; }
  .lc-header { background: var(--lc-header-bg); color: #fff; display: flex; align-items: center; justify-content: space-between; padding: 10px 12px; }
  .lc-title { font: 600 15px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; margin: 0; }
  .lc-close { appearance: none; border: none; background: transparent; color: #fff; width: 32px; height: 32px; border-radius: 6px; cursor: pointer; display: grid; place-items: center; }
  .lc-close:hover { background: rgba(255,255,255,0.08); }
  .lc-close:focus-visible { outline: 3px solid #93c5fd; outline-offset: 2px; }
  .lc-body { background: var(--lc-surface); display: grid; grid-template-rows: 1fr auto; }
  .lc-messages { height: 300px; overflow-y: auto; padding: 12px; background: var(--lc-body-bg); }
  .lc-row { display: flex; margin-bottom: 8px; }
  .lc-row.user { justify-content: flex-end; }
  .lc-row.bot { justify-content: flex-start; }
  .lc-msg { max-width: 85%; padding: 8px 10px; border-radius: 14px; font: 14px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; box-shadow: 0 1px 0 rgba(0,0,0,0.05); }
  .lc-msg.user { background: var(--lc-primary); color: #fff; border-bottom-right-radius: 4px; }
  .lc-msg.bot { background: #eef2ff; color: var(--lc-text); border-bottom-left-radius: 4px; }
  .lc-quick { background: var(--lc-surface); border-top: 1px solid var(--lc-muted); padding: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
  .lc-quick button { appearance: none; border: 1px solid var(--lc-muted); background: #fff; border-radius: 8px; padding: 8px 10px; text-align: left; cursor: pointer; font: 500 13px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; color: var(--lc-text); transition: background var(--lc-transition), border-color var(--lc-transition), transform var(--lc-transition); }
  .lc-quick button:hover { background: #f3f4f6; }
  .lc-quick button:active { transform: translateY(1px); }
  .lc-quick button:focus-visible { outline: 3px solid #93c5fd; outline-offset: 2px; }
  @media (max-width: 420px) { .lc-panel { width: calc(100vw - 24px); } .lc-messages { height: min(50vh, 380px); } }
  @media (prefers-reduced-motion: reduce) { .lc-panel, .lc-toggle { transition: none; } }
</style>
<!-- Live Chat Widget Markup -->
<div id="lc-panel" class="lc-panel" role="dialog" aria-modal="true" aria-labelledby="lc-title" aria-hidden="true">
  <div class="lc-header">
    <h2 class="lc-title" id="lc-title">Chat</h2>
    <button type="button" class="lc-close" id="lc-close" aria-label="Close chat" title="Close chat">x</button>
  </div>
  <div class="lc-body">
    <div class="lc-messages" id="lc-messages" aria-live="polite" aria-atomic="false"></div>
    <div class="lc-quick" id="lc-quick"></div>
  </div>
</div>
<button id="lc-toggle" class="lc-toggle" aria-label="Open chat" aria-controls="lc-panel" aria-expanded="false" title="Open chat">Chat</button>
<!-- Live Chat Widget Script -->
<script>
  // config: Four Q&A items (edit here)
  const LC_QA_ITEMS = [
    { q: 'What are your support hours?', a: 'Our team is available Monday-Friday, 9am-6pm (local time).' },
    { q: 'How can I contact sales?', a: 'Email sales@example.com and we will reply within 1 business day.' },
    { q: 'Where can I track my order?', a: 'Visit the Orders page and enter your confirmation number to track.' },
    { q: 'Do you offer refunds?', a: 'Yes - within 30 days. Please review our refund policy for details.' }
  ];
  (function() {
    // elements
    const panel = document.getElementById('lc-panel');
    const toggleBtn = document.getElementById('lc-toggle');
    const closeBtn = document.getElementById('lc-close');
    const quick = document.getElementById('lc-quick');
    const messages = document.getElementById('lc-messages');
    let isOpen = false;
    let lastFocused = null;
    // render: quick question buttons
    function renderQuickButtons() {
      quick.innerHTML = '';
      LC_QA_ITEMS.forEach((item, idx) => {
        const b = document.createElement('button');
        b.type = 'button';
        b.textContent = item.q;
        b.setAttribute('data-index', String(idx));
        b.addEventListener('click', () => handleQuestionClick(idx));
        quick.appendChild(b);
      });
    }
    // render: append message bubbles and keep scrolled
    function appendMessage(text, who) {
      const row = document.createElement('div');
      row.className = 'lc-row ' + (who === 'user' ? 'user' : 'bot');
      const msg = document.createElement('div');
      msg.className = 'lc-msg ' + (who === 'user' ? 'user' : 'bot');
      msg.textContent = text;
      row.appendChild(msg);
      messages.appendChild(row);
      messages.scrollTop = messages.scrollHeight;
    }
    // handlers: click on a quick question
    function handleQuestionClick(index) {
      const item = LC_QA_ITEMS[index];
      if (!item) return;
      appendMessage(item.q, 'user');
      appendMessage(item.a, 'bot');
    }
    // accessibility helpers
    function getFocusable(root) {
      return Array.prototype.slice.call(
        root.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')
      ).filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));
    }
    // open/close: panel controls with focus management and ARIA updates
    function openPanel() {
      if (isOpen) return;
      isOpen = true;
      lastFocused = document.activeElement;
      panel.classList.add('is-open');
      panel.setAttribute('aria-hidden', 'false');
      toggleBtn.setAttribute('aria-expanded', 'true');
      setTimeout(() => {
        const f = getFocusable(panel);
        (f[0] || closeBtn).focus();
      }, 0);
      document.addEventListener('keydown', handleKeydown, true);
    }
    function closePanel() {
      if (!isOpen) return;
      isOpen = false;
      panel.classList.remove('is-open');
      panel.setAttribute('aria-hidden', 'true');
      toggleBtn.setAttribute('aria-expanded', 'false');
      document.removeEventListener('keydown', handleKeydown, true);
      if (lastFocused && typeof lastFocused.focus === 'function') { lastFocused.focus(); } else { toggleBtn.focus(); }
    }
    // focus trap & ESC
    function handleKeydown(e) {
      if (!isOpen) return;
      if (e.key === 'Escape') { e.preventDefault(); closePanel(); return; }
      if (e.key === 'Tab') {
        const focusables = getFocusable(panel);
        if (focusables.length === 0) return;
        const first = focusables[0];
        const last = focusables[focusables.length - 1];
        const active = document.activeElement;
        if (e.shiftKey) {
          if (active === first || !panel.contains(active)) { e.preventDefault(); last.focus(); }
        } else {
          if (active === last || !panel.contains(active)) { e.preventDefault(); first.focus(); }
        }
      }
    }
    // wiring
    toggleBtn.addEventListener('click', () => (isOpen ? closePanel() : openPanel()));
    closeBtn.addEventListener('click', closePanel);
    // init
    renderQuickButtons();
  })();
</script>

