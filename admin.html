<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NVDS Admin Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="admin.css">
</head>
<body>
  <div class="admin-shell">
    <aside class="admin-sidebar" aria-label="Dashboard navigation">
      <div class="admin-sidebar__brand">
        <span class="admin-sidebar__logo">NVDS</span>
        <p class="admin-sidebar__subtitle">Site Admin</p>
      </div>
      <nav class="admin-sidebar__nav" id="page-nav">
        <!-- Fallback static nav; replaced by admin.js if it loads -->
        <a class="admin-nav__item" href="#dashboard" data-page-id="dashboard" onclick="if(window.activatePage){activatePage('dashboard'); return false;}">Dashboard</a>
        <a class="admin-nav__item" href="#global" data-page-id="global" onclick="if(window.activatePage){activatePage('global'); return false;}">Global elements</a>
        <a class="admin-nav__item" href="#home" data-page-id="home" onclick="if(window.activatePage){activatePage('home'); return false;}">Home page</a>
        <a class="admin-nav__item" href="#about" data-page-id="about" onclick="if(window.activatePage){activatePage('about'); return false;}">About page</a>
        <a class="admin-nav__item" href="#causes" data-page-id="causes" onclick="if(window.activatePage){activatePage('causes'); return false;}">Causes page</a>
        <a class="admin-nav__item" href="#blog" data-page-id="blog" onclick="if(window.activatePage){activatePage('blog'); return false;}">Blog page</a>
        <a class="admin-nav__item" href="#contact" data-page-id="contact" onclick="if(window.activatePage){activatePage('contact'); return false;}">Contact page</a>
        <a class="admin-nav__item" href="#volunteer" data-page-id="volunteer" onclick="if(window.activatePage){activatePage('volunteer'); return false;}">Volunteer page</a>
        <a class="admin-nav__item" href="#donate" data-page-id="donate" onclick="if(window.activatePage){activatePage('donate'); return false;}">Donate page</a>
      </nav>
      <div class="admin-sidebar__footer">
        <a href="index.html" class="admin-sidebar__link">← Back to site</a>
      </div>
    </aside>

    <main class="admin-main" id="overview">
      <header class="admin-banner">
        <div class="admin-banner__copy">
          <p class="admin-banner__eyebrow">NVDS Admin Console</p>
          <h1 class="admin-banner__title" id="page-heading">Dashboard overview</h1>
          <p class="admin-banner__description" id="page-description"></p>
        </div>
        <div class="admin-banner__actions">
          <span class="admin-banner__status" id="active-page-label"></span>
          <button type="button" class="admin-banner__refresh" id="import-readme">Import from README</button>
          <button type="button" class="admin-banner__refresh" id="reload-preview">Refresh preview</button>
        </div>
      </header>

      <section class="admin-insights" id="dashboard-insights" hidden>
        <h2 class="admin-section__title">Site snapshot</h2>
        <div class="insight-grid" id="dashboard-cards"></div>
      </section>

      <section class="admin-note" id="page-note" hidden>
        <div class="admin-note__card">
          <h2 id="page-note-title"></h2>
          <p id="page-note-body"></p>
        </div>
      </section>

      <section class="admin-content">
        <div class="admin-content__header">
          <h2>Content controls</h2>
          <p id="content-intro">Choose a page from the navigation to start editing.</p>
        </div>
        <div class="control-grid" id="content-controls"></div>
      </section>
    </main>
  </div>

  <template id="content-control-template">
    <article class="content-card">
      <div class="content-card__header">
        <div>
          <h3></h3>
          <p class="content-card__description"></p>
        </div>
        <span class="content-card__status" aria-live="polite">Saved</span>
      </div>
      <div class="content-card__layout">
        <form class="content-card__form"></form>
        <div class="content-card__media" hidden>
          <h4 class="content-card__media-title">Images</h4>
          <div class="content-card__media-list"></div>
        </div>
      </div>
    </article>
  </template>

  <template id="content-field-template">
    <label class="content-field">
      <span class="content-field__label"></span>
      <input type="text">
    </label>
  </template>

  <template id="content-image-template">
    <div class="content-image">
      <div class="content-image__preview slot-card__preview">
        <div class="image-frame" aria-hidden="true"></div>
        <span class="slot-card__placeholder">No image uploaded yet</span>
      </div>
      <div class="content-image__details">
        <h4></h4>
        <span class="content-image__dimensions"></span>
        <p class="content-image__note"></p>
        <div class="slot-card__actions">
          <label class="file-label">
            <input type="file" accept="image/*">
            <span>Upload image</span>
          </label>
          <button type="button" class="btn btn--ghost">Remove</button>
        </div>
      </div>
    </div>
  </template>

  <script src="admin.js"></script>
  <script>
    // Simple Chat Q&A admin tools (local page-only, no backend)
    (function(){
      const KEY = 'nvds_chat_qa';

      function byId(id){ return document.getElementById(id); }
      function loadQA(){
        try {
          const raw = localStorage.getItem(KEY);
          if (!raw) return null;
          const arr = JSON.parse(raw);
          if (!Array.isArray(arr)) return null;
          return arr;
        } catch(_) { return null; }
      }
      function saveQA(arr){
        localStorage.setItem(KEY, JSON.stringify(arr));
      }

      function initChatAdmin(){
        const host = document.querySelector('.admin-main');
        if (!host) return;
        const section = document.createElement('section');
        section.className = 'admin-content';
        section.innerHTML = `
          <div class="admin-content__header">
            <h2>Chat Widget</h2>
            <p>Edit the four Help? questions and answers shown in the live chat.</p>
          </div>
          <article class="content-card">
            <div class="content-card__header">
              <div>
                <h3>Quick Q&A</h3>
                <p class="content-card__description">Exactly four items. Empty fields will be ignored.</p>
              </div>
              <span class="content-card__status" id="chat-qa-status" aria-live="polite">Saved</span>
            </div>
            <form class="content-card__form" id="chat-qa-form">
              ${[1,2,3,4].map(i => `
                <fieldset class="content-field" style="margin-bottom:12px">
                  <legend style="font-weight:600;margin-bottom:6px">Item ${i}</legend>
                  <label class="content-field" style="margin-bottom:6px">
                    <span class="content-field__label">Question ${i}</span>
                    <input type="text" id="q${i}" placeholder="Question ${i}">
                  </label>
                  <label class="content-field">
                    <span class="content-field__label">Answer ${i}</span>
                    <textarea id="a${i}" rows="2" placeholder="Answer ${i}" style="width:100%; resize:vertical"></textarea>
                  </label>
                </fieldset>
              `).join('')}
              <div style="display:flex; gap:8px; margin-top:8px">
                <button type="button" class="btn btn--ghost" id="qa-load">Load current</button>
                <button type="submit" class="btn btn--primary" id="qa-save">Save Q&A</button>
              </div>
            </form>
          </article>`;
        host.appendChild(section);

        const status = byId('chat-qa-status');
        function setStatus(text){ status.textContent = text; }

        function fill(arr){
          (arr||[]).forEach((it, idx) => {
            const i = idx+1;
            const q = byId('q'+i), a = byId('a'+i);
            if (q) q.value = it && it.q || '';
            if (a) a.value = it && it.a || '';
          });
        }

        // Load defaults from site script if available
        function getDefaults(){
          const fallback = [
            { q: 'What are your support hours?', a: 'Our team is available Monday-Friday, 9am-6pm (local time).' },
            { q: 'How can I contact sales?', a: 'Email sales@example.com and we will reply within 1 business day.' },
            { q: 'Where can I track my order?', a: 'Visit the Orders page and enter your confirmation number to track.' },
            { q: 'Do you offer refunds?', a: 'Yes - within 30 days. Please review our refund policy for details.' }
          ];
          try { return window.LC_QA_ITEMS || fallback; } catch(_) { return fallback; }
        }

        // Wire buttons
        byId('qa-load').addEventListener('click', () => {
          const stored = loadQA();
          fill(stored || getDefaults());
          setStatus(stored ? 'Loaded current' : 'Loaded defaults');
        });

        byId('chat-qa-form').addEventListener('submit', (e) => {
          e.preventDefault();
          const items = [];
          for (let i=1;i<=4;i++){
            const q = byId('q'+i).value.trim();
            const a = byId('a'+i).value.trim();
            if (q && a) items.push({q,a});
          }
          if (!items.length) {
            setStatus('Nothing to save');
            return;
          }
          saveQA(items);
          setStatus('Saved');
        });

        // Populate on load
        const initial = loadQA() || getDefaults();
        fill(initial);
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initChatAdmin);
      } else {
        initChatAdmin();
      }
    })();
  </script>
</body>
</html>




